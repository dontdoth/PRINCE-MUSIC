from PRINCEMUSIC import app 
import asyncio
import random
from pyrogram import Client, filters
from pyrogram.enums import ChatType, ChatMemberStatus
from pyrogram.errors import UserNotParticipant
from pyrogram.types import ChatPermissions

spam_chats = []

EMOJI = [
    "ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹",
    "ğŸ§šâ€â™€ï¸ğŸŒ¸ğŸ§‹ğŸ¬ğŸ«–",
    "ğŸ¥€ğŸŒ·ğŸŒ¹ğŸŒºğŸ’",
    "ğŸŒ¸ğŸŒ¿ğŸ’®ğŸŒ±ğŸŒµ",
    "â¤ï¸ğŸ’šğŸ’™ğŸ’œğŸ–¤",
    "ğŸ’“ğŸ’•ğŸ’ğŸ’—ğŸ’–",
    "ğŸŒ¸ğŸ’ğŸŒºğŸŒ¹ğŸ¦‹",
    "ğŸ”ğŸ¦ªğŸ›ğŸ²ğŸ¥—",
    "ğŸğŸ“ğŸ’ğŸ‘ğŸŒ¶ï¸",
    "ğŸ§‹ğŸ¥¤ğŸ§ƒğŸ¥›ğŸ·",
    "ğŸ¬ğŸ­ğŸ§ğŸ‚ğŸ¡",
    "ğŸ¨ğŸ§‰ğŸºâ˜•ğŸ»",
    "ğŸ¥ªğŸ¥§ğŸ¦ğŸ¥ğŸš",
    "ğŸ«–â˜•ğŸ¹ğŸ·ğŸ¥›",
    "â˜•ğŸ§ƒğŸ©ğŸ¦ğŸ™",
    "ğŸğŸŒ¾ğŸ’®ğŸ‚ğŸŒ¿",
    "ğŸŒ¨ï¸ğŸŒ¥ï¸â›ˆï¸ğŸŒ©ï¸ğŸŒ§ï¸",
    "ğŸŒ·ğŸµï¸ğŸŒ¸ğŸŒºğŸ’",
    "ğŸ’®ğŸŒ¼ğŸŒ»ğŸ€ğŸ",
    "ğŸ­ğŸ‘»ğŸ‘¾ğŸªğŸ¨",
    "ğŸŒºğŸŒ¸ğŸŒ¼ğŸŒ»ğŸŒ¹",
    "ğŸªğŸ­ğŸ¨ğŸªğŸ«",
    "ğŸ“ğŸğŸ‰ğŸŠğŸ‹",
    "ğŸŒğŸğŸğŸ‡ğŸ¥",
    "ğŸ¥ğŸ¥¨ğŸ¥–ğŸ¥¯ğŸ¥",
    "ğŸ§‡ğŸ§€ğŸ¥—ğŸ¥™ğŸ¥ª",
    "ğŸŒ­ğŸ”ğŸŸğŸ•ğŸ¥©",
    "ğŸ—ğŸ–ğŸ¦´ğŸŒ®ğŸŒ¯",
    "ğŸ¥˜ğŸğŸ¥«ğŸ«•ğŸ¥£",
    "ğŸ²ğŸ›ğŸœğŸ¢ğŸ±",
    "ğŸšğŸ¤ğŸ£ğŸ¦ªğŸ˜",
    "ğŸ¡ğŸ§ğŸ¨ğŸ¦ğŸ¥§",
    "ğŸ§ğŸ°ğŸ‚ğŸ®ğŸ­",
    "ğŸ¬ğŸ«ğŸ¿ğŸ©ğŸª",
    "ğŸŒ°ğŸ¥œğŸ¯ğŸ§‚ğŸ§ˆ",
    "ğŸ·ğŸ¥‚ğŸ»ğŸºğŸ¶",
    "ğŸ§ƒğŸ§ŠğŸ¥¤ğŸ§‹ğŸ¹",
    "ğŸ¾ğŸ¥›â˜•ğŸ«–ğŸµ",
    "ğŸµğŸ¶ğŸ¼ğŸ¹ğŸ¸",
    "ğŸºğŸ»ğŸ¥ğŸ¤ğŸ§"
]

TAGMES = [
    "**Ø³Ù„Ø§Ù… Ø¹Ø²ÛŒØ²Ù… Ú©Ø¬Ø§ÛŒÛŒØŸ ğŸ¤—**",
    "**Ø¯Ù„Ù… Ø¨Ø±Ø§Øª ØªÙ†Ú¯ Ø´Ø¯Ù‡ ğŸ’**",
    "**Ø¨ÛŒØ§ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø´Ùˆ Ø¯ÛŒÚ¯Ù‡ ğŸ˜Š**",
    "**Ú†Ø±Ø§ Ø¬ÙˆØ§Ø¨ Ù†Ù…ÛŒØ¯ÛŒØŸ ğŸ¥º**",
    "**Ú©Ø¬Ø§ Ø±ÙØªÛŒ ÛŒÙ‡ÙˆØŸ ğŸ‘€**",
    "**Ø¨ÛŒØ§ Ù¾ÛŒÙˆÛŒ Ú©Ø§Ø±Øª Ø¯Ø§Ø±Ù… ğŸ˜‰**",
    "**Ú†Ù‡ Ø®Ø¨Ø±ØŸ ğŸ˜ƒ**",
    "**Ø®ÙˆØ¨ÛŒ Ø¹Ø²ÛŒØ²Ù…ØŸ â¤ï¸**",
    "**Ø§Ù…Ø±ÙˆØ² Ú†ÛŒÚ©Ø§Ø±Ø§ Ú©Ø±Ø¯ÛŒØŸ ğŸŒ¸**",
    "**Ù…ÛŒØ§ÛŒ Ø¨Ø±ÛŒÙ… Ø¨ÛŒØ±ÙˆÙ†ØŸ ğŸˆ**",
    "**Ø­ÙˆØµÙ„Ù… Ø³Ø± Ø±ÙØªÙ‡ ğŸ¥±**",
    "**Ù¾Ø§ÛŒÙ‡ Ø§ÛŒ Ø¨Ø±ÛŒÙ… Ú¯Ø±Ø¯Ø´ØŸ ğŸŒŸ**",
    "**Ú†Ø±Ø§ Ø§ÛŒÙ†Ù‚Ø¯Ø± Ø®ÙˆØ´Ú¯Ù„ÛŒ ØªÙˆØŸ ğŸ˜**",
    "**Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù… ğŸ’•**",
    "**Ø¨ÛŒØ§ Ø¨Ø§Ù‡Ù… Ø­Ø±Ù Ø¨Ø²Ù†ÛŒÙ… ğŸ—£ï¸**",
    "**Ú†Ø±Ø§ Ø§ÛŒÙ†Ù‚Ø¯Ø± Ù…Ø§Ù‡ÛŒØŸ ğŸŒ™**",
    "**Ú©ÛŒ Ù…ÛŒØ§ÛŒ Ù¾ÛŒØ´Ù…ØŸ ğŸƒâ€â™€ï¸**",
    "**Ø¯Ù„Ù… Ù‡ÙˆØ§ØªÙˆ Ú©Ø±Ø¯Ù‡ ğŸ’«**",
    "**ÛŒÙ‡ Ù¾ÛŒØ§Ù… Ø¨Ø¯Ù‡ Ø®Ø¨ ğŸ“**",
    "**Ú©Ø¬Ø§ÛŒÛŒ Ù¾Ø³ØŸ ğŸ‘£**",
    "**Ø¨ÛŒØ§ ÙˆÙˆÛŒØ³ Ú†Øª ğŸ¤**",
    "**Ú†Ø±Ø§ Ø¢ÙÙ„Ø§ÛŒÙ†ÛŒØŸ ğŸ’­**",
    "**Ù¾ÛŒØ§Ù… Ù‡Ø§Ù…Ùˆ Ù†Ù…ÛŒØ¨ÛŒÙ†ÛŒØŸ ğŸ‘€**",
    "**ÛŒÙ‡ Ø²Ù†Ú¯ Ø¨Ø²Ù† ğŸ“**",
    "**Ù‚Ù‡Ø±ÛŒ Ø¨Ø§Ù‡Ø§Ù…ØŸ ğŸ¥º**",
    "**Ù…ÛŒØ´Ù‡ Ø¨Ø±Ú¯Ø±Ø¯ÛŒØŸ ğŸ™**",
    "**Ø®ÛŒÙ„ÛŒ Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù… â¤ï¸**",
    "**Ø¨ÛŒØ§ ÛŒÙ‡ ÙÛŒÙ„Ù… Ø¨Ø¨ÛŒÙ†ÛŒÙ… ğŸ¬**",
    "**Ù…ÙˆØ²ÛŒÚ© Ú¯ÙˆØ´ Ù…ÛŒØ¯ÛŒØŸ ğŸµ**",
    "**Ø§Ù…Ø´Ø¨ Ø¨ÛŒØ¯Ø§Ø±ÛŒØŸ ğŸŒ™**",
    "**ØµØ¨Ø­Øª Ø¨Ø®ÛŒØ± Ø¹Ø²ÛŒØ²Ù… ğŸŒ…**",
    "**Ø´Ø¨ Ø¨Ø®ÛŒØ± Ú¯Ù„Ù… ğŸŒƒ**",
    "**Ø®ÙˆØ§Ø¨ÛŒØ¯ÛŒ Ù‡Ù†ÙˆØ²ØŸ ğŸ˜´**",
    "**Ù¾Ø§Ø´Ùˆ Ø¯ÛŒÚ¯Ù‡ â°**",
    "**Ù†Ø§Ù‡Ø§Ø± Ø®ÙˆØ±Ø¯ÛŒØŸ ğŸœ**",
    "**Ú†ÛŒ Ù¾Ø®ØªÛŒ Ø§Ù…Ø±ÙˆØ²ØŸ ğŸ‘©â€ğŸ³**",
    "**Ù…ÛŒØ§ÛŒ Ø¨Ø±ÛŒÙ… Ø®Ø±ÛŒØ¯ØŸ ğŸ›ï¸**",
    "**Ù‡ÙˆØ§ Ú†Ø·ÙˆØ±Ù‡ Ø§ÙˆÙ†Ø¬Ø§? â›…**",
    "**Ø¨Ø§Ø±ÙˆÙ† Ù…ÛŒØ§Ø¯? ğŸŒ§ï¸**",
    "**Ú†Ù‡ Ø®Ø¨Ø± Ø§Ø² Ø¯Ø±Ø³ Ùˆ Ú©Ø§Ø±? ğŸ“š**",
    "**Ø®Ø³ØªÙ‡ Ù†Ø¨Ø§Ø´ÛŒ Ø¹Ø²ÛŒØ²Ù… ğŸ’ª**",
    "**ÛŒÙ‡ Ø¹Ú©Ø³ Ø¨ÙØ±Ø³Øª ğŸ“¸**",
    "**Ú©ÛŒ Ù…ÛŒØ§ÛŒ Ø¢Ù†Ù„Ø§ÛŒÙ†? ğŸŸ¢**",
    "**Ø¯Ù„Ù… Ø¨Ø±Ø§Øª ÛŒÙ‡ Ø°Ø±Ù‡ Ø´Ø¯Ù‡ ğŸ’—**",
    "**ÛŒØ§Ø¯Ù… Ú©Ø±Ø¯ÛŒ Ø§Ù…Ø±ÙˆØ²? ğŸ¤”**",
    "**Ø¨ÛŒØ§ Ú†Øª Ú©Ù†ÛŒÙ… ğŸ’­**",
    "**Ú†Ø±Ø§ Ø¬ÙˆØ§Ø¨ Ù†Ù…ÛŒØ¯ÛŒ Ø®Ø¨? ğŸ“±**",
    "**Ú©Ø¬Ø§ÛŒ Ø´Ù‡Ø±ÛŒ? ğŸŒ†**",
    "**Ø¨ÛŒØ±ÙˆÙ† Ø¨Ø§Ø±ÙˆÙ†Ù‡? â›ˆï¸**",
    "**Ú†ÛŒÚ©Ø§Ø± Ù…ÛŒÚ©Ù†ÛŒ? ğŸ‘€**",
    "**Ø­Ø§Ù„Øª Ú†Ø·ÙˆØ±Ù‡? ğŸ’**",
    "**Ø®ÙˆØ´ Ù…ÛŒÚ¯Ø°Ø±Ù‡? ğŸ‰**",
    "**Ù…Ù†Ùˆ ÙØ±Ø§Ù…ÙˆØ´ Ú©Ø±Ø¯ÛŒ? ğŸ’”**",
    "**ÛŒØ§Ø¯ØªÙ‡ Ù‚Ø¯ÛŒÙ…Ø§ Ø±Ùˆ? ğŸ­**",
    "**Ø¨ÛŒØ§ ÛŒÙ‡ Ø¨Ø§Ø²ÛŒ Ú©Ù†ÛŒÙ… ğŸ®**",
    "**Ø­ÙˆØµÙ„Øª Ø³Ø± Ù†Ø±ÙØªÙ‡? ğŸ¥±**",
    "**Ú†Ù‡ Ø®Ø¨Ø± Ø§Ø² Ø¯ÙˆØ³ØªØ§Øª? ğŸ‘¥**",
    "**Ù…Ù‡Ù…ÙˆÙ†ÛŒ Ù†Ù…ÛŒØ§ÛŒ? ğŸŠ**",
    "**Ú©ÛŒ Ø¨Ø±Ù…ÛŒÚ¯Ø±Ø¯ÛŒ? ğŸ”„**",
    "**Ø¯ÙˆØ³ØªØª Ø¯Ø§Ø±Ù… Ø®ÛŒÙ„ÛŒ ğŸ’˜**",
    "**Ø¨ÛŒØ§ Ù¾ÛŒØ´ Ù…Ù† ğŸƒ**",
    "**Ú©Ø¬Ø§ ØºÛŒØ¨Øª Ø²Ø¯ ÛŒÙ‡Ùˆ? ğŸ‘»**",
    "**Ø¯Ù„ØªÙ†Ú¯ØªÙ… Ø®ÛŒÙ„ÛŒ ğŸ’–**",
    "**ÛŒÙ‡ Ù¾ÛŒØ§Ù… Ú©ÙˆÚ†ÙˆÙ„Ùˆ Ø¨Ø¯Ù‡ ğŸ“¨**",
    "**Ú†Ø±Ø§ Ø¯ÛŒØ± Ø¬ÙˆØ§Ø¨ Ù…ÛŒØ¯ÛŒ? â³**",
    "**ÛŒØ§Ø¯ÛŒ Ø§Ø² Ù…Ø§ Ù†Ù…ÛŒÚ©Ù†ÛŒ ğŸ¥º**",
    "**Ø®ÛŒÙ„ÛŒ Ø¨ÛŒ Ù…Ø¹Ø±ÙØªÛŒ ğŸ˜”**",
    "**Ø¨ÛŒØ§ ÛŒÚ©Ù… Ø­Ø±Ù Ø¨Ø²Ù†ÛŒÙ… ğŸ—£ï¸**",
    "**Ú†Ù‚Ø¯Ø± Ø¯Ù„Ù… Ø¨Ø±Ø§Øª ØªÙ†Ú¯Ù‡ ğŸ’—**",
    "**Ú©Ø§Ø´ Ù¾ÛŒØ´Ù… Ø¨ÙˆØ¯ÛŒ ğŸŒŸ**",
    "**ÛŒÙ‡ Ø²Ù†Ú¯ Ø¨Ø²Ù† ØµØ¯Ø§ØªÙˆ Ø¨Ø´Ù†ÙˆÙ… ğŸ“**",
    "**Ø§Ù…Ø±ÙˆØ² Ú†Ù‡ Ø®Ø¨Ø±? ğŸ“°**",
    "**Ù†Ø¨ÛŒÙ†Ù… ØºÙ…ØªÙˆ ğŸ¥º**",
    "**Ù„Ø¨Ø®Ù†Ø¯ ÛŒØ§Ø¯Øª Ù†Ø±Ù‡ ğŸ˜Š**",
    "**Ù…ÙˆØ§Ø¸Ø¨ Ø®ÙˆØ¯Øª Ø¨Ø§Ø´ â¤ï¸**",
    "**Ø¯ÙˆØ³Øª Ø¯Ø§Ø±Ù… Ø¹Ø²ÛŒØ²Ù… ğŸ’•**",
    "**Ù‚Ø±Ø¨ÙˆÙ†Øª Ø¨Ø±Ù… Ù…Ù† ğŸ¥°**",
    "**ÙØ¯Ø§Øª Ø´Ù… Ø§Ù„Ù‡ÛŒ ğŸ’–**",
    "**Ø¨ÙˆØ³ Ø¨Ù‡ Ø±ÙˆÛŒ Ù…Ø§Ù‡Øª ğŸ˜˜**",
    "**Ø¹Ø´Ù‚ Ù…Ù†ÛŒ ØªÙˆ ğŸ’**",
    "**Ø²Ù†Ø¯Ú¯ÛŒÙ…ÛŒ Ø¹Ø²ÛŒØ²Ù… â¤ï¸**",
    "**Ù†ÙØ³Ù…ÛŒ Ú¯Ù„Ù… ğŸ’—**",
    "**Ø¹Ø´Ù‚ Ø¯Ù„Ù…ÛŒ ğŸ’“**",
    "**Ù…Ø§Ù‡ Ù…Ù†ÛŒ ØªÙˆ ğŸŒ™**",
    "**Ø®ÙˆØ´Ú¯Ù„ Ø®Ø§Ù†ÙˆÙ… Ú©Ø¬Ø§ÛŒÛŒØŸ ğŸ‘¸**",
    "**Ø¢Ù‚Ø§ÛŒ Ú¯Ù„ Ú©Ø¬Ø§ÛŒÛŒØŸ ğŸ¤´**"
]

@app.on_message(filters.command(["ØªÚ¯", "Ø§Ø³Ù¾Ù…", "ØªÚ¯_Ù‡Ù…Ù‡", "ØªÚ¯_Ú©Ø§Ø±Ø¨Ø±Ø§Ù†"], prefixes=["/", "@", "#"]))
async def mentionall(client, message):
    chat_id = message.chat.id
    if message.chat.type == ChatType.PRIVATE:
        return await message.reply("Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± ÙÙ‚Ø· Ø¯Ø± Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ©Ù†Ø¯.")

    is_admin = False
    try:
        participant = await client.get_chat_member(chat_id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("Ø´Ù…Ø§ Ø§Ø¯Ù…ÛŒÙ† Ù†ÛŒØ³ØªÛŒØ¯ØŒ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ Ø§Ø² Ø§ÛŒÙ† Ø¯Ø³ØªÙˆØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†Ù†Ø¯.")

    if message.reply_to_message and message.text:
        return await message.reply("Ù„Ø·ÙØ§ Ø¨Ù‡ Ø§ÛŒÙ† Ø´Ú©Ù„ ØªÚ¯ Ú©Ù†ÛŒØ¯: /ØªÚ¯ ÛŒØ§ Ø±ÙˆÛŒ Ù¾ÛŒØ§Ù… Ø±ÛŒÙ¾Ù„Ø§ÛŒ Ú©Ù†ÛŒØ¯")
    elif message.text:
        mode = "text_on_cmd"
        msg = message.text
    elif message.reply_to_message:
        mode = "text_on_reply"
        msg = message.reply_to_message
        if not msg:
            return await message.reply("Ù„Ø·ÙØ§ Ø¨Ù‡ Ø§ÛŒÙ† Ø´Ú©Ù„ ØªÚ¯ Ú©Ù†ÛŒØ¯: /ØªÚ¯ ÛŒØ§ Ø±ÙˆÛŒ Ù¾ÛŒØ§Ù… Ø±ÛŒÙ¾Ù„Ø§ÛŒ Ú©Ù†ÛŒØ¯")
    else:
        return await message.reply("Ù„Ø·ÙØ§ Ø¨Ù‡ Ø§ÛŒÙ† Ø´Ú©Ù„ ØªÚ¯ Ú©Ù†ÛŒØ¯: /ØªÚ¯ ÛŒØ§ Ø±ÙˆÛŒ Ù¾ÛŒØ§Ù… Ø±ÛŒÙ¾Ù„Ø§ÛŒ Ú©Ù†ÛŒØ¯")

    if chat_id in spam_chats:
        return await message.reply("Ù„Ø·ÙØ§ ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ ÙØ±Ø§ÛŒÙ†Ø¯ Ù‚Ø¨Ù„ÛŒ ØªÙ…Ø§Ù… Ø´ÙˆØ¯...")
    spam_chats.append(chat_id)
    usrnum = 0
    usrtxt = ""
    
    async for usr in client.get_chat_members(chat_id):
        if not chat_id in spam_chats:
            break
        if usr.user.is_bot:
            continue
        usrnum += 1
        usrtxt += f"[{usr.user.first_name}](tg://user?id={usr.user.id}) "

        if usrnum == 1:
            if mode == "text_on_cmd":
                txt = f"{usrtxt} {random.choice(TAGMES)}"
                await client.send_message(chat_id, txt)
            elif mode == "text_on_reply":
                await msg.reply(f"[{random.choice(EMOJI)}](tg://user?id={usr.user.id})")
            await asyncio.sleep(4)
            usrnum = 0
            usrtxt = ""
    try:
        spam_chats.remove(chat_id)
    except:
        pass

@app.on_message(filters.command(["ØªÙˆÙ‚Ù_ØªÚ¯", "Ù¾Ø§ÛŒØ§Ù†_ØªÚ¯"]))
async def cancel_spam(client, message):
    if not message.chat.id in spam_chats:
        return await message.reply("Ø¯Ø± Ø­Ø§Ù„ Ø­Ø§Ø¶Ø± Ù‡ÛŒÚ† ØªÚ¯ÛŒ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ Ù†ÛŒØ³Øª...")
    is_admin = False
    try:
        participant = await client.get_chat_member(message.chat.id, message.from_user.id)
    except UserNotParticipant:
        is_admin = False
    else:
        if participant.status in (
            ChatMemberStatus.ADMINISTRATOR,
            ChatMemberStatus.OWNER
        ):
            is_admin = True
    if not is_admin:
        return await message.reply("Ø´Ù…Ø§ Ø§Ø¯Ù…ÛŒÙ† Ù†ÛŒØ³ØªÛŒØ¯ØŒ ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ù†Ø¯ ØªÚ¯ Ø±Ø§ Ù…ØªÙˆÙ‚Ù Ú©Ù†Ù†Ø¯.")
    else:
        try:
            spam_chats.remove(message.chat.id)
        except:
            pass
        return await message.reply("â™¦ ØªÚ¯ Ù…ØªÙˆÙ‚Ù Ø´Ø¯ â™¦")
